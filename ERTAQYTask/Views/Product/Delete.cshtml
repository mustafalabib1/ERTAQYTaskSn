@model PLProject.ViewModel.ProductViewModel.DetialProductViewModel

@{
    ViewData["Title"] = "Delete Product";
}

<div class="container mt-4 fade-in">
    <div class="row justify-content-center">
        <div class="col-lg-8 col-xl-7">
            <div class="card shadow-lg border-danger">
                <div class="card-header bg-danger text-white">
                    <h3 class="mb-0">
                        <i class="bi bi-exclamation-triangle"></i> Delete Product
                    </h3>
                </div>
                <div class="card-body">
                    <div class="alert alert-danger d-flex align-items-center" role="alert">
                        <i class="bi bi-exclamation-triangle-fill fs-4 me-3"></i>
                        <div>
                            <h5 class="alert-heading mb-1">Are you sure you want to delete this product?</h5>
                            <p class="mb-0">This action cannot be undone. The product will be permanently removed.</p>
                        </div>
                    </div>

                    <div class="bg-light p-4 rounded-3 mb-4">
                        <h5 class="mb-3">
                            <i class="bi bi-info-circle"></i> Product Information
                        </h5>
                        <div class="row g-3">
                            <div class="col-12">
                                <div class="d-flex align-items-center">
                                    <i class="bi bi-tag-fill text-primary me-2"></i>
                                    <strong class="me-2">Product Name:</strong>
                                    <span>@Model.Name</span>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="d-flex align-items-center">
                                    <i class="bi bi-currency-dollar text-success me-2"></i>
                                    <strong class="me-2">Price:</strong>
                                    <span class="badge bg-success">@Model.Price.ToString("C")</span>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="d-flex align-items-center">
                                    <i class="bi bi-calendar-check text-info me-2"></i>
                                    <strong class="me-2">Created:</strong>
                                    <span>@Model.CreationDate.ToString("MMM dd, yyyy")</span>
                                </div>
                            </div>
                            <div class="col-12">
                                <div class="d-flex align-items-center">
                                    <i class="bi bi-building text-warning me-2"></i>
                                    <strong class="me-2">Service Provider:</strong>
                                    <span>@(Model.ServiceProviderName ?? "N/A")</span>
                                </div>
                            </div>
                        </div>
                    </div>

                    <form asp-action="Delete" method="post" id="deleteForm">
                        <input type="hidden" asp-for="Id" />
                        
                        <div class="form-check mb-4">
                            <input class="form-check-input" 
                                   type="checkbox" 
                                   id="confirmDelete" 
                                   required>
                            <label class="form-check-label" for="confirmDelete">
                                I understand that this action is permanent and cannot be undone
                            </label>
                        </div>

                        <div class="d-flex justify-content-between gap-3 flex-wrap">
                            <a asp-action="Index" class="btn btn-secondary btn-lg">
                                <i class="bi bi-x-circle"></i> Cancel
                            </a>
                            <button type="submit" 
                                    class="btn btn-danger btn-lg" 
                                    id="deleteBtn"
                                    disabled>
                                <i class="bi bi-trash"></i> Delete Product
                            </button>
                        </div>
                    </form>
                </div>
            </div>

            <div class="mt-3 text-center">
                <a asp-action="Details" asp-route-id="@Model.Id" class="text-muted">
                    <i class="bi bi-eye"></i> View full details instead
                </a>
            </div>
        </div>
    </div>
</div>

@section Scripts {
    <script>
        // Enable delete button only when checkbox is checked
        var confirmCheckbox = document.getElementById('confirmDelete');
        var deleteBtn = document.getElementById('deleteBtn');

        confirmCheckbox.addEventListener('change', function() {
            deleteBtn.disabled = !this.checked;
            if (this.checked) {
                deleteBtn.classList.remove('btn-secondary');
                deleteBtn.classList.add('btn-danger');
            } else {
                deleteBtn.classList.remove('btn-danger');
                deleteBtn.classList.add('btn-secondary');
            }
        });

        // Add loading state and confirmation
        document.getElementById('deleteForm').addEventListener('submit', function(e) {
            e.preventDefault();
            
            if (confirm('Are you absolutely sure? This is your last chance to cancel.')) {
                var btn = document.getElementById('deleteBtn');
                btn.disabled = true;
                btn.innerHTML = '<span class="spinner-border spinner-border-sm me-2" role="status" aria-hidden="true"></span>Deleting...';
                this.submit();
            }
        });
    </script>
}
